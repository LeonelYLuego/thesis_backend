import{a as G}from"./chunk-TK3OXWJG.js";import{a as y,c as E,f as F}from"./chunk-XGZPP6NI.js";import{a as L}from"./chunk-J23ELMUS.js";import"./chunk-7FSHLLYC.js";import{Aa as t,Ab as M,Ba as r,Bb as P,Ca as c,Cb as q,Eb as R,Fb as V,Gb as k,Ha as g,Ka as i,Qa as S,X as v,Zb as K,c as h,fb as z,gb as w,oa as l,ob as b,pa as p,qb as _,rb as s,sb as x,tb as C,ub as I,vb as d,wb as U,xa as u,xb as A,yb as N,za as j,zb as T}from"./chunk-TTSPFW42.js";var B=(()=>{let n=class n{constructor(e,a,m,f){this.authService=e,this.matSnackBar=a,this.router=m,this.route=f,this.logInForm=new I({username:new d("",[s.required,s.pattern(/^[a-z.]*$/)]),password:new d("",[s.required])})}ngOnInit(){this.publicKey=this.route.snapshot.queryParams.publicKey,this.redirectTo=this.route.snapshot.queryParams.redirectTo}goSignUp(){this.router.navigate(["/","auth","sign-up"],{queryParams:this.publicKey&&this.redirectTo?{publicKey:this.publicKey,redirectTo:this.redirectTo}:void 0})}logIn(){return h(this,null,function*(){if(this.logInForm.valid){let e=this.logInForm.value;try{let a=yield this.authService.logIn({username:e.username,password:e.password});localStorage.setItem("token",a.token),localStorage.setItem("account",JSON.stringify(a.account)),this.publicKey&&this.redirectTo?this.router.navigate(["/","oauth"],{queryParams:{publicKey:this.publicKey,redirectTo:this.redirectTo}}):this.router.navigate(["/"])}catch(a){a.status&&a.status==401&&this.matSnackBar.open("Nombre de usuario o contrase\xF1a incorrecto",void 0,{verticalPosition:"bottom",horizontalPosition:"end",duration:2e3,panelClass:"primary-snackbar"})}}})}};n.\u0275fac=function(a){return new(a||n)(p(G),p(k),p(E),p(y))},n.\u0275cmp=v({type:n,selectors:[["app-log-in"]],standalone:!0,features:[S],decls:24,vars:1,consts:[[1,"w-full","h-screen","flex","flex-row","justify-center","items-center"],[1,"bg-neutral-800","rounded-md","shadow-md","p-3","w-full","max-w-lg","m-4",3,"formGroup","ngSubmit"],[1,"text-xl","font-bold","text-primary","mb-4"],[1,"flex","flex-row","justify-center","m-4","mb-8"],["src","assets/images/login.svg",1,"w-80"],["appearance","outline",1,"w-full","mb-2"],["matInput","","formControlName","username"],["matInput","","type","password","formControlName","password"],[1,"flex","flex-row","justify-center","mb-4"],[1,"text-primary","hover:underline","cursor-pointer","hover:text-orange-600",3,"click"],[1,"flex","flex-row-reverse"],["mat-raised-button","","color","primary","type","submit"]],template:function(a,m){a&1&&(t(0,"div",0)(1,"form",1),g("ngSubmit",function(){return m.logIn()}),t(2,"h1",2),i(3,"Iniciar Sesi\xF3n"),r(),t(4,"div",3),c(5,"img",4),r(),t(6,"mat-form-field",5)(7,"mat-label"),i(8,"Nombre de usuario"),r(),c(9,"input",6),t(10,"mat-error"),i(11,"Nombre de usuario inv\xE1lido"),r()(),t(12,"mat-form-field",5)(13,"mat-label"),i(14,"Contrase\xF1a"),r(),c(15,"input",7),t(16,"mat-error"),i(17,"Contrase\xF1a inv\xE1lida"),r()(),t(18,"div",8)(19,"a",9),g("click",function(){return m.goSignUp()}),i(20,"\xBFNo tienes una cuenta?, Reg\xEDstrate"),r()(),t(21,"div",10)(22,"button",11),i(23," Iniciar sesi\xF3n "),r()()()()),a&2&&(l(1),u("formGroup",m.logInForm))},dependencies:[w,T,U,_,x,C,M,A,N,K,b,V,R,P,q,F]});let o=n;return o})();function X(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos una min\xFAscula"),r())}function Y(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos una may\xFAscula"),r())}function ee(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos un n\xFAmero"),r())}function te(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos 8 caracteres"),r())}function re(o,n){o&1&&(t(0,"mat-error"),i(1,"Contrase\xF1as no coinciden"),r())}function ie(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos una min\xFAscula"),r())}function oe(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos una may\xFAscula"),r())}function ne(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos un n\xFAmero"),r())}function ae(o,n){o&1&&(t(0,"mat-error"),i(1,"Al menos 8 caracteres"),r())}function me(o,n){o&1&&(t(0,"mat-error"),i(1,"Contrase\xF1as no coinciden"),r())}var D=(()=>{let n=class n{constructor(e,a,m,f){this.accountsService=e,this.matSnackBar=a,this.router=m,this.route=f,this.signUpForm=new I({username:new d("",[s.required,s.pattern(/^[a-z.]*$/),s.maxLength(32)]),firstName:new d("",[s.required,s.maxLength(64)]),lastName:new d("",[s.required,s.maxLength(64)]),phone:new d("",[s.required,s.pattern(/^\d{10}$/)]),password:new d("",[s.required,s.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/),s.maxLength(64)]),repeatPassword:new d("",[s.required,s.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/),s.maxLength(64)])})}ngOnInit(){this.publicKey=this.route.snapshot.queryParams.publicKey,this.redirectTo=this.route.snapshot.queryParams.redirectTo}validatePassword(){let e=this.signUpForm.controls.password;e.updateValueAndValidity(),e.value&&(/[a-z]/.test(e.value)?/[A-Z]/.test(e.value)?/\d/.test(e.value)?/[a-zA-Z\d]{8,}/.test(e.value)||e.setErrors({minimum:!0}):e.setErrors({number:!0}):e.setErrors({upperCase:!0}):e.setErrors({lowerCase:!0}))}validateRepeatPassword(){let e=this.signUpForm.controls.repeatPassword;e.updateValueAndValidity(),e.value&&(/[a-z]/.test(e.value)?/[A-Z]/.test(e.value)?/\d/.test(e.value)?/[a-zA-Z\d]{8,}/.test(e.value)||e.setErrors({minimum:!0}):e.setErrors({number:!0}):e.setErrors({upperCase:!0}):e.setErrors({lowerCase:!0}))}signUp(){return h(this,null,function*(){this.signUpForm.controls.password.updateValueAndValidity(),this.signUpForm.controls.repeatPassword.updateValueAndValidity();let e=this.signUpForm.value;if(e.password!=e.repeatPassword&&(this.signUpForm.controls.password.setErrors({different:!0}),this.signUpForm.controls.repeatPassword.setErrors({different:!0})),this.signUpForm.valid)try{delete e.repeatPassword,yield this.accountsService.create(e),this.publicKey&&this.redirectTo?this.router.navigate(["/","auth","log-in"],{queryParams:{publicKey:this.publicKey,redirectTo:this.redirectTo}}):this.router.navigate(["/","auth","log-in"])}catch(a){a.status&&a.status==400&&(this.signUpForm.controls.username.setErrors({incorrect:!0}),this.matSnackBar.open("Nombre de usuario ya existente",void 0,{verticalPosition:"bottom",horizontalPosition:"end",duration:2e3,panelClass:"primary-snackbar"}))}})}};n.\u0275fac=function(a){return new(a||n)(p(L),p(k),p(E),p(y))},n.\u0275cmp=v({type:n,selectors:[["app-sign-up"]],standalone:!0,features:[S],decls:49,vars:11,consts:[[1,"w-full","h-screen","flex","flex-row","justify-center","items-center"],[1,"bg-neutral-800","rounded-md","shadow-md","p-3","w-full","max-w-lg","m-4",3,"formGroup","ngSubmit"],[1,"text-xl","font-bold","text-primary","mb-4"],["appearance","outline",1,"w-full","mb-2"],["matInput","","formControlName","username"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["matInput","","formControlName","phone"],["matInput","","type","password","formControlName","password",3,"change"],[4,"ngIf"],["matInput","","type","password","formControlName","repeatPassword",3,"change"],[1,"flex","flex-row-reverse"],["mat-raised-button","","color","primary","type","submit"]],template:function(a,m){a&1&&(t(0,"div",0)(1,"form",1),g("ngSubmit",function(){return m.signUp()}),t(2,"h1",2),i(3,"Registrarse"),r(),t(4,"mat-form-field",3)(5,"mat-label"),i(6,"Nombre de usuario"),r(),c(7,"input",4),t(8,"mat-error"),i(9,"Nombre de usuario inv\xE1lido"),r()(),t(10,"mat-form-field",3)(11,"mat-label"),i(12,"Nombre(s)"),r(),c(13,"input",5),t(14,"mat-error"),i(15,"Nombre inv\xE1lido"),r()(),t(16,"mat-form-field",3)(17,"mat-label"),i(18,"Apellido(s)"),r(),c(19,"input",6),t(20,"mat-error"),i(21,"Apellido inv\xE1lido"),r()(),t(22,"mat-form-field",3)(23,"mat-label"),i(24,"Tel\xE9fono"),r(),c(25,"input",7),t(26,"mat-error"),i(27,"Tel\xE9fono inv\xE1lido"),r()(),t(28,"mat-form-field",3)(29,"mat-label"),i(30,"Contrase\xF1a"),r(),t(31,"input",8),g("change",function(){return m.validatePassword()}),r(),j(32,X,2,0,"mat-error",9)(33,Y,2,0,"mat-error",9)(34,ee,2,0,"mat-error",9)(35,te,2,0,"mat-error",9)(36,re,2,0,"mat-error",9),r(),t(37,"mat-form-field",3)(38,"mat-label"),i(39,"Repetir contrase\xF1a"),r(),t(40,"input",10),g("change",function(){return m.validateRepeatPassword()}),r(),j(41,ie,2,0,"mat-error",9)(42,oe,2,0,"mat-error",9)(43,ne,2,0,"mat-error",9)(44,ae,2,0,"mat-error",9)(45,me,2,0,"mat-error",9),r(),t(46,"div",11)(47,"button",12),i(48," Registrarse "),r()()()()),a&2&&(l(1),u("formGroup",m.signUpForm),l(31),u("ngIf",m.signUpForm.controls.password.hasError("lowerCase")),l(1),u("ngIf",m.signUpForm.controls.password.hasError("upperCase")),l(1),u("ngIf",m.signUpForm.controls.password.hasError("number")),l(1),u("ngIf",m.signUpForm.controls.password.hasError("minimum")),l(1),u("ngIf",m.signUpForm.controls.password.hasError("different")),l(5),u("ngIf",m.signUpForm.controls.repeatPassword.hasError("lowerCase")),l(1),u("ngIf",m.signUpForm.controls.repeatPassword.hasError("upperCase")),l(1),u("ngIf",m.signUpForm.controls.repeatPassword.hasError("number")),l(1),u("ngIf",m.signUpForm.controls.repeatPassword.hasError("minimum")),l(1),u("ngIf",m.signUpForm.controls.repeatPassword.hasError("different")))},dependencies:[w,z,T,U,_,x,C,M,A,N,K,b,V,R,P,q,F]});let o=n;return o})();var se=[{path:"log-in",component:B},{path:"sign-up",component:D}],Ce=se;export{Ce as default};
