import{a as G}from"./chunk-TK3OXWJG.js";import{a as y,c as x,f as w}from"./chunk-XGZPP6NI.js";import{a as L}from"./chunk-J23ELMUS.js";import"./chunk-7FSHLLYC.js";import{Aa as e,Ab as U,Ba as t,Bb as A,Ca as m,Cb as k,Eb as K,Fb as R,Gb as j,Ha as c,Ka as r,Qa as b,X as h,Zb as _,c as f,gb as S,oa as g,ob as F,pa as l,qb as E,rb as o,sb as C,tb as I,ub as N,vb as u,wb as M,xa as v,xb as T,yb as P,zb as q}from"./chunk-TTSPFW42.js";var V=(()=>{let a=class a{constructor(n,i,s,d){this.authService=n,this.matSnackBar=i,this.router=s,this.route=d,this.logInForm=new N({username:new u("",[o.required,o.pattern(/^[a-z.]*$/)]),password:new u("",[o.required])})}ngOnInit(){this.publicKey=this.route.snapshot.queryParams.publicKey,this.redirectTo=this.route.snapshot.queryParams.redirectTo}goSignUp(){this.router.navigate(["/","auth","sign-up"],{queryParams:this.publicKey&&this.redirectTo?{publicKey:this.publicKey,redirectTo:this.redirectTo}:void 0})}logIn(){return f(this,null,function*(){if(this.logInForm.valid){let n=this.logInForm.value;try{let i=yield this.authService.logIn({username:n.username,password:n.password});localStorage.setItem("token",i.token),localStorage.setItem("account",JSON.stringify(i.account)),this.publicKey&&this.redirectTo?this.router.navigate(["/","oauth"],{queryParams:{publicKey:this.publicKey,redirectTo:this.redirectTo}}):this.router.navigate(["/"])}catch(i){i.status&&i.status==401&&this.matSnackBar.open("Nombre de usuario o contrase\xF1a incorrecto",void 0,{verticalPosition:"bottom",horizontalPosition:"end",duration:2e3,panelClass:"primary-snackbar"})}}})}};a.\u0275fac=function(i){return new(i||a)(l(G),l(j),l(x),l(y))},a.\u0275cmp=h({type:a,selectors:[["app-log-in"]],standalone:!0,features:[b],decls:24,vars:1,consts:[[1,"w-full","h-screen","flex","flex-row","justify-center","items-center"],[1,"bg-neutral-800","rounded-md","shadow-md","p-3","w-full","max-w-lg","m-4",3,"formGroup","ngSubmit"],[1,"text-xl","font-bold","text-primary","mb-4"],[1,"flex","flex-row","justify-center","m-4","mb-8"],["src","assets/images/login.svg",1,"w-80"],["appearance","outline",1,"w-full","mb-2"],["matInput","","formControlName","username"],["matInput","","type","password","formControlName","password"],[1,"flex","flex-row","justify-center","mb-4"],[1,"text-primary","hover:underline","cursor-pointer","hover:text-orange-600",3,"click"],[1,"flex","flex-row-reverse"],["mat-raised-button","","color","primary","type","submit"]],template:function(i,s){i&1&&(e(0,"div",0)(1,"form",1),c("ngSubmit",function(){return s.logIn()}),e(2,"h1",2),r(3,"Iniciar Sesi\xF3n"),t(),e(4,"div",3),m(5,"img",4),t(),e(6,"mat-form-field",5)(7,"mat-label"),r(8,"Nombre de usuario"),t(),m(9,"input",6),e(10,"mat-error"),r(11,"Nombre de usuario inv\xE1lido"),t()(),e(12,"mat-form-field",5)(13,"mat-label"),r(14,"Contrase\xF1a"),t(),m(15,"input",7),e(16,"mat-error"),r(17,"Contrase\xF1a inv\xE1lida"),t()(),e(18,"div",8)(19,"a",9),c("click",function(){return s.goSignUp()}),r(20,"\xBFNo tienes una cuenta?, Reg\xEDstrate"),t()(),e(21,"div",10)(22,"button",11),r(23," Iniciar sesi\xF3n "),t()()()()),i&2&&(g(1),v("formGroup",s.logInForm))},dependencies:[S,q,M,E,C,I,U,T,P,_,F,R,K,A,k,w]});let p=a;return p})();var B=(()=>{let a=class a{constructor(n,i,s,d){this.accountsService=n,this.matSnackBar=i,this.router=s,this.route=d,this.signUpForm=new N({username:new u("",[o.required,o.pattern(/^[a-z.]*$/),o.maxLength(32)]),firstName:new u("",[o.required,o.maxLength(64)]),lastName:new u("",[o.required,o.maxLength(64)]),phone:new u("",[o.required,o.pattern(/^\d{10}$/)]),password:new u("",[o.required,o.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/),o.maxLength(64)]),repeatPassword:new u("",[o.required,o.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/),o.maxLength(64)])})}ngOnInit(){this.publicKey=this.route.snapshot.queryParams.publicKey,this.redirectTo=this.route.snapshot.queryParams.redirectTo}signUp(){return f(this,null,function*(){this.signUpForm.controls.password.updateValueAndValidity(),this.signUpForm.controls.repeatPassword.updateValueAndValidity();let n=this.signUpForm.value;if(n.password!=n.repeatPassword&&(this.signUpForm.controls.password.setErrors({incorrect:!0}),this.signUpForm.controls.repeatPassword.setErrors({incorrect:!0})),this.signUpForm.valid)try{delete n.repeatPassword,yield this.accountsService.create(n),this.publicKey&&this.redirectTo?this.router.navigate(["/","auth","log-in"],{queryParams:{publicKey:this.publicKey,redirectTo:this.redirectTo}}):this.router.navigate(["/","auth","log-in"])}catch(i){i.status&&i.status==400&&(this.signUpForm.controls.username.setErrors({incorrect:!0}),this.matSnackBar.open("Nombre de usuario ya existente",void 0,{verticalPosition:"bottom",horizontalPosition:"end",duration:2e3,panelClass:"primary-snackbar"}))}})}};a.\u0275fac=function(i){return new(i||a)(l(L),l(j),l(x),l(y))},a.\u0275cmp=h({type:a,selectors:[["app-sign-up"]],standalone:!0,features:[b],decls:43,vars:1,consts:[[1,"w-full","h-screen","flex","flex-row","justify-center","items-center"],[1,"bg-neutral-800","rounded-md","shadow-md","p-3","w-full","max-w-lg","m-4",3,"formGroup","ngSubmit"],[1,"text-xl","font-bold","text-primary","mb-4"],["appearance","outline",1,"w-full","mb-2"],["matInput","","formControlName","username"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["matInput","","formControlName","phone"],["matInput","","type","password","formControlName","password"],["matInput","","type","password","formControlName","repeatPassword"],[1,"flex","flex-row-reverse"],["mat-raised-button","","color","primary","type","submit"]],template:function(i,s){i&1&&(e(0,"div",0)(1,"form",1),c("ngSubmit",function(){return s.signUp()}),e(2,"h1",2),r(3,"Registrarse"),t(),e(4,"mat-form-field",3)(5,"mat-label"),r(6,"Nombre de usuario"),t(),m(7,"input",4),e(8,"mat-error"),r(9,"Nombre de usuario inv\xE1lido"),t()(),e(10,"mat-form-field",3)(11,"mat-label"),r(12,"Nombre(s)"),t(),m(13,"input",5),e(14,"mat-error"),r(15,"Nombre inv\xE1lido"),t()(),e(16,"mat-form-field",3)(17,"mat-label"),r(18,"Apellido(s)"),t(),m(19,"input",6),e(20,"mat-error"),r(21,"Apellido inv\xE1lido"),t()(),e(22,"mat-form-field",3)(23,"mat-label"),r(24,"Tel\xE9fono"),t(),m(25,"input",7),e(26,"mat-error"),r(27,"Tel\xE9fono inv\xE1lido"),t()(),e(28,"mat-form-field",3)(29,"mat-label"),r(30,"Contrase\xF1a"),t(),m(31,"input",8),e(32,"mat-error"),r(33,"Contrase\xF1a inv\xE1lida"),t()(),e(34,"mat-form-field",3)(35,"mat-label"),r(36,"Repetir contrase\xF1a"),t(),m(37,"input",9),e(38,"mat-error"),r(39,"Contrase\xF1a inv\xE1lida"),t()(),e(40,"div",10)(41,"button",11),r(42," Registrarse "),t()()()()),i&2&&(g(1),v("formGroup",s.signUpForm))},dependencies:[S,q,M,E,C,I,U,T,P,_,F,R,K,A,k,w]});let p=a;return p})();var Q=[{path:"log-in",component:V},{path:"sign-up",component:B}],ce=Q;export{ce as default};
